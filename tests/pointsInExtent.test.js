import { checkResult, DELTA_BGS } from './test';
import { BGSCoordinates, projections } from '../src/main';

describe(`Test BGS Coordinates in extent dS = ${DELTA_BGS}m`, () => {
  const tr = new BGSCoordinates();
  let input = [
    [4541923.842621584422886, 8478245.736685760319233],
    [4548092.455784041434526, 8480000.112906275317073],
    [4552506.692725983448327, 8485036.870442593470216],
    [4556185.223510934971273, 8491545.040292892605066],
    [4558901.677013668231666, 8499128.472988022491336],
    [4560486.274890262633562, 8514295.338378285989165],
    [4561957.68720424361527, 8526010.04410882294178],
    [4560542.867671569809318, 8537441.785932825878263],
    [4558958.269794975407422, 8545591.146441025659442],
    [4551827.579350300133228, 8548081.228818532079458],
    [4540395.837526296265423, 8550344.940070809796453],
    [4528794.317358372732997, 8549156.491663364693522],
    [4524776.22988557908684, 8547458.708224155008793],
    [4521946.590820232406259, 8542025.801218688488007],
    [4519852.657911875285208, 8535291.260243162512779],
    [4517758.725003518164158, 8521312.843260345980525],
    [4519513.101224033161998, 8508749.245810205116868],
    [4520079.029037103056908, 8499468.029675865545869],
    [4518890.580629657022655, 8491148.890823744237423],
    [4518947.173410964198411, 8480679.226281959563494],
    [4524832.822666886262596, 8477679.808872690424323],
    [4533944.260457305237651, 8477962.772779224440455],
    [4538698.054087088443339, 8476774.324371779337525],
    [4553129.213320359587669, 8475416.097620412707329],
    [4560316.496546342037618, 8476038.618214789777994],
    [4543395.254935564473271, 8486508.282756574451923],
    [4533717.889332077465951, 8491601.633074199780822],
    [4526756.977231322787702, 8497826.839017963036895],
    [4530095.951328432187438, 8514974.451753968372941],
    [4533095.368737700395286, 8534951.703555321320891],
    [4538811.239649701863527, 8541346.687843006104231],
    [4548884.754722339101136, 8540271.424998173490167],
    [4554317.661727805621922, 8532744.585084348917007],
    [4554091.290602577850223, 8513729.410565216094255],
    [4549563.868098022416234, 8495732.906109606847167],
    [4536943.677866572514176, 8493412.602076021954417],
    [4541301.322027208283544, 8500316.921395469456911],
    [4538754.646868395619094, 8512880.518845612183213],
    [4533548.110988155938685, 8517407.941350167617202],
    [4533095.368737700395286, 8523859.518419159576297],
    [4540056.280838455073535, 8532574.806740429252386],
    [4543282.069372951053083, 8522444.698886485770345],
    [4550356.167036319151521, 8506825.091245768591762],
    [4553695.141133429482579, 8503882.266617806628346],
    [4555789.07404178660363, 8507617.390184065327048],
    [4563881.841768679209054, 8498902.101862795650959],
    [4532472.848143324255943, 8506542.127339232712984],
    [4525511.936042569577694, 8525387.523514445871115],
    [4527153.126700471155345, 8487923.102289248257875],
    [4546451.265126139856875, 8517181.57022493891418],
    [4552110.543256835080683, 8523519.961731316521764],
    [4546338.079563526436687, 8532518.213959122076631],
    [4560486.274890262633562, 8483339.087003385648131],
    [4529926.172984511591494, 8540101.6466542519629],
    [4543961.182748634368181, 8508353.09634105488658],
    [4525115.786573421210051, 8513106.88997083902359],
    [4537679.38402356300503, 8482999.530315544456244],
    [4542433.177653347142041, 8491035.705261129885912],
    [4528454.760670530609787, 8534102.811835715547204],
    [4546281.486782219260931, 8526689.157484507188201],
    [4544300.739436475560069, 8541233.50228039175272],
    [4557826.414168836548924, 8525104.559607911854982],
    [4520248.807381023652852, 8528556.719267636537552],
    [4526587.198887402191758, 8506032.79230746999383]
  ];
  let expected = [
    [4670275.594, 299820.143],
    [4676398.966, 301725.971],
    [4680687.637, 306869.83],
    [4684204.61, 313466.435],
    [4686733.384, 321114.194],
    [4687944.089, 336314.881],
    [4689126.776, 348061.763],
    [4687431.31, 359454.785],
    [4685646.922, 367562.408],
    [4678457.432, 369876.416],
    [4666973.797, 371858.481],
    [4655405.14, 370385.34],
    [4651430.01, 368589.342],
    [4648734.769, 363088.546],
    [4646807.037, 356304.562],
    [4645057.533, 342278.836],
    [4647120.55, 329762.171],
    [4647914.8, 320497.677],
    [4646931.584, 312151.765],
    [4647246.092, 301686.63],
    [4653203.879, 298833.169],
    [4662305.524, 299340.606],
    [4667087.102, 298269.699],
    [4681547.025, 297267.616],
    [4688716.54, 298067.081],
    [4671542.943, 308116.271],
    [4661743.198, 312969.595],
    [4654631.134, 319021.426],
    [4657546.963, 336245.927],
    [4660054.034, 356290.706],
    [4665610.869, 362824.177],
    [4675707.547, 361996.881],
    [4681323.712, 354606.122],
    [4681565.196, 335591.773],
    [4677482.322, 317489.816],
    [4664923.364, 314859.445],
    [4669109.59, 321868.865],
    [4666254.462, 334365.735],
    [4660938.164, 338763.6],
    [4660326.838, 345202.009],
    [4667071.186, 354085.722],
    [4670545.096, 344038.226],
    [4678001.252, 328597.83],
    [4681411.56, 325738.186],
    [4683412.84, 329523.598],
    [4691717.417, 321010.533],
    [4660130.658, 327874.737],
    [4652708.166, 346543.005],
    [4655271.086, 309130.495],
    [4673842.75, 338854.787],
    [4679344.216, 345330.31],
    [4673352.34, 354183.613],
    [4688706.357, 305369.235],
    [4656759.208, 361361.125],
    [4671570.753, 329967.918],
    [4652614.29, 334256.387],
    [4665915.354, 304467.814],
    [4670469.65, 312618.524],
    [4655435.744, 355327.979],
    [4673439.127, 348355.078],
    [4671101.382, 362845.963],
    [4685019.186, 347054.972],
    [4647368.682, 349581.79],
    [4654259.37, 327220.676]
  ];

  it('Transform with provided extent', () => {
    let extent = [4515891.16322039, 8471284.82458501, 4565579.62520789, 8551929.53794741];
    let result = tr.transformArray(input, projections.BGS_1970_К9, projections.BGS_2005_KK, true, extent, 0);

    for (let i = 0; i < result.length; i++) {
      checkResult(expected[i], result[i], 0.2);
    }
  });

  it('Transform with calculated extent', () => {
    let result = tr.transformArray(input, projections.BGS_1970_К9, projections.BGS_2005_KK, true);

    for (let i = 0; i < result.length; i++) {
      checkResult(expected[i], result[i], 0.2);
    }
  });
});
